# Тема урока: методы множеств

1. Методы _union(), intersection(), difference(), symmetric_difference()_
2. Методы _update(), intersection_update(), difference_update(), symmetric_difference_update()_
3. Операторы _&, |, -, ^_

**Аннотация**. Урок посвящен методам множеств, которые реализуют основные операции над множествами.

# Операции над множествами

Основные операции над множествами:

- объединение множеств;
- пересечение множеств;
- разность множеств;
- симметрическая разность множеств.

Для каждой операции есть метод и оператор.

## Объединение множеств: метод union()

**Объединение** множеств – это множество, состоящее из элементов, принадлежащих хотя бы одному из объединяемых множеств. Для этой операции существует метод _union()_.

Приведенный ниже код:

```python
myset1 = {1, 2, 3, 4, 5}
myset2 = {3, 4, 6, 7, 8}

myset3 = myset1.union(myset2)
print(myset3)
```

выводит (порядок элементов может отличаться):

```python
{1, 2, 3, 4, 5, 6, 7, 8}
```

​Обратите внимание, метод _union()_ **возвращает новое множество** в которое входят все элементы множеств _myset1_ и _myset2_. Для изменения текущего множества используется метод _update()_.

Для объединения двух множеств можно также использовать оператор _|_.

Результат выполнения приведенного ниже кода:

```python
myset1 = {1, 2, 3, 4, 5}
myset2 = {3, 4, 6, 7, 8}

myset3 = myset1 | myset2
print(myset3)
```

аналогичен предыдущему.

## Пересечение множеств: метод intersection()

**Пересечение** множеств – это множество, состоящее из элементов, принадлежащих одновременно каждому из пересекающихся множеств. Для этой операции существует метод _intersection()_.

Приведенный ниже код:

```python
myset1 = {1, 2, 3, 4, 5}
myset2 = {3, 4, 6, 7, 8}

myset3 = myset1.intersection(myset2)
print(myset3)
```

выводит (порядок элементов может отличаться):

```python
{3, 4}
```

​Обратите внимание, метод _intersection()_ возвращает новое множество в которое входят общие элементы множеств _myset1 и myset2_. Для изменения текущего множества используется метод _intersection_update()_.

Для пересечения двух множеств можно также использовать оператор _&_.

Результат выполнения приведенного ниже кода:

```python
myset1 = {1, 2, 3, 4, 5}
myset2 = {3, 4, 6, 7, 8}

myset3 = myset1 & myset2
print(myset3)
```

аналогичен предыдущему.

## Разность множеств: метод difference()

**Разность** множеств – это множество, в которое входят все элементы первого множества, не входящие во второе множество. Для этой операции существует метод _difference()_.

Приведенный ниже код:

```python
myset1 = {1, 2, 3, 4, 5}
myset2 = {3, 4, 6, 7, 8}

myset3 = myset1.difference(myset2)
print(myset3)
```

выводит (порядок элементов может отличаться):

```python
{1, 2, 5}
```

Для разности двух множеств можно также использовать оператор _-_.

Результат выполнения приведенного ниже кода:

```python
myset1 = {1, 2, 3, 4, 5}
myset2 = {3, 4, 6, 7, 8}

myset3 = myset1 - myset2
print(myset3)
```

аналогичен предыдущему.

Обратите внимание: для операции разности множеств важен порядок, в котором указаны множества. Если поменять местами _myset1 и myset2_, нас ожидает совсем другой результат: элементы, входящие в множество _myset2_ и которых нет в множестве _myset1_.

Приведенный ниже код:

```python
myset1 = {1, 2, 3, 4, 5}
myset2 = {3, 4, 6, 7, 8}

myset3 = myset2.difference(myset1)
print(myset3)
```

выводит (порядок элементов может отличаться):

```python
{8, 6, 7}
```

## Симметрическая разность: метод symmetric_difference()

**Симметрическая разность** множеств – это множество, включающее все элементы исходных множеств, не принадлежащие одновременно обоим исходным множествам. Для этой операции существует метод _symmetric_difference()_.

Приведенный ниже код:

```python
myset1 = {1, 2, 3, 4, 5}
myset2 = {3, 4, 6, 7, 8}

myset3 = myset1.symmetric_difference(myset2)
print(myset3)
```

выводит (порядок элементов может отличаться):

```python
{1, 2, 5, 6, 7, 8}
```

Для симметрической разности двух множеств можно также использовать оператор _^_.

Результат выполнения приведенного ниже кода:

```python
myset1 = {1, 2, 3, 4, 5}
myset2 = {3, 4, 6, 7, 8}

myset3 = myset1 ^ myset2
print(myset3)
```

аналогичен предыдущему.

​Обратите внимание: для операции симметрической разности порядок множеств не важен, на то она и симметрическая: _myset1 ^ myset2 == myset2 ^ myset1_.

# Методы множеств, изменяющие текущие множества

Методы _union(), intersection(), difference(), symmetric_difference()_ не изменяют исходные множества, а возвращают новые. Часто на практике нужно изменять исходные множества. Для таких целей используются парные методы _update(), intersection_update(), difference_update(), symmetric_difference_update()_.

## Метод update()

Метод _update()_ изменяет исходное множество **по объединению**.

Приведенный ниже код:

```python
myset1 = {1, 2, 3, 4, 5}
myset2 = {3, 4, 6, 7, 8}

myset1.update(myset2)  # изменяем множество myset1
print(myset1)
```

выводит (порядок элементов может отличаться):

```python
{1, 2, 3, 4, 5, 6, 7, 8}
```

Аналогичный результат получается, если использовать оператор _|=_:

```python
myset1 = {1, 2, 3, 4, 5}
myset2 = {3, 4, 6, 7, 8}

myset1 |= myset2
print(myset1)
```

## Метод intersection_update()

Метод _intersection_update()_ изменяет исходное множество **по пересечению**.

Приведенный ниже код:

```python
myset1 = {1, 2, 3, 4, 5}
myset2 = {3, 4, 6, 7, 8}

myset1.intersection_update(myset2)  # изменяем множество myset1
print(myset1)
```

выводит (порядок элементов может отличаться):

```python
{3, 4}
```

Аналогичный результат получается, если использовать оператор _&=_:

```python
myset1 = {1, 2, 3, 4, 5}
myset2 = {3, 4, 6, 7, 8}

myset1 &= myset2
print(myset1)
```

## Метод difference_update()

Метод _difference_update()_ изменяет исходное множество **по разности**.

Приведенный ниже код:

```python
myset1 = {1, 2, 3, 4, 5}
myset2 = {3, 4, 6, 7, 8}

myset1.difference_update(myset2)  # изменяем множество myset1
print(myset1)
```

выводит (порядок элементов может отличаться):

```python
{1, 2, 5}
```

Аналогичный результат получается, если использовать оператор _-=_:

```python
myset1 = {1, 2, 3, 4, 5}
myset2 = {3, 4, 6, 7, 8}

myset1 -= myset2
print(myset1)
```

## Метод symmetric_difference_update()

Метод _symmetric_difference_update()_ изменяет исходное множество **по симметрической разности**.

Приведенный ниже код:

```python
myset1 = {1, 2, 3, 4, 5}
myset2 = {3, 4, 6, 7, 8}

myset1.symmetric_difference_update(myset2)  # изменяем множество myset1
print(myset1)
```

выводит (порядок элементов может отличаться):

```python
{1, 2, 5, 6, 7, 8}
```

Аналогичный результат получается, если использовать оператор _^=_:

```python
myset1 = {1, 2, 3, 4, 5}
myset2 = {3, 4, 6, 7, 8}

myset1 ^= myset2
print(myset1)
```

# Примечания

**Примечание 1**. Все основные операции над множествами выполняются двумя способами: при помощи метода или соответствующего ему оператора. Различие заключается в том, что метод может принимать в качестве аргумента не только множество (тип данных _set_), но и любой итерируемый объект (список, строку, кортеж..).

Приведенный ниже код:

```python
mylist = [2021, 2020, 2019, 2018, 2017, 2016]
mytuple = (2021, 2020, 2016)
mystr = 'abcd'

myset = {2009, 2010, 2016}

print(myset.union(mystr))                      # объединяем со строкой
print(myset.intersection(mylist))              # пересекаем со списком
print(myset.difference(mytuple))               # находим разность с кортежем
```

выводит (порядок элементов может отличаться):

```python
{2016, 'c', 'b', 'a', 'd', 2009, 2010}
{2016}
{2009, 2010}
```

Приведенный ниже код:

```python
mylist = [2021, 2020, 2019, 2018, 2017, 2016]
mytuple = (2021, 2020, 2016)
mystr = 'abcd'

myset = {2009, 2010, 2016}

print(myset | mystr)
print(myset & mylist)
print(myset - mytuple)
```

приводит к возникновению ошибок:

```python
TypeError: unsupported operand type(s) for |: 'set' and 'str'
TypeError: unsupported operand type(s) for &: 'set' and 'list'
TypeError: unsupported operand type(s) for -: 'set' and 'tuple'
```

**Примечание 2**. Некоторые методы (_union(), intersection(), difference()_) и операторы (_|, &, -, ^_) позволяют совершать операции над несколькими множествами сразу.

Приведенный ниже код:

```python
myset1 = {1, 2, 3, 4, 5, 6}
myset2 = {2, 3, 4, 5}
myset3 = {5, 6, 7, 8}

union1 = myset1.union(myset2, myset3)
union2 = myset1 | myset2 | myset3

difference1 = myset1.difference(myset2, myset3)
difference2 = myset1 - myset2 - myset3           # порядок выполнения слева-направо

print(union1 == union2)
print(difference1 == difference2)
```

выводит:

```python
True
True
```

**Примечание 3**. Оператор _^_ симметрической разности позволяет использовать несколько множеств, а метод _symmetric_difference()_ – нет.

Приведенный ниже код:

```python
myset1 = {1, 2, 3, 4, 5, 6}
myset2 = {2, 3, 4, 7}
myset3 = {6, 20, 30}

symdifference = myset1 ^ myset2 ^ myset3  # порядок выполнения слева-направо

print(symdifference)
```

выводит (порядок элементов может отличаться):

```python
{1, 5, 7, 20, 30}
```

Приведенный ниже код:

```python
myset1 = {1, 2, 3, 4, 5, 6}
myset2 = {2, 3, 4, 7}
myset3 = {6, 20, 30}

symdifference = myset1.symmetric_difference(myset2, myset3)

print(symdifference)
```

приводит к ошибке:

```python
TypeError: symmetric_difference() takes exactly one argument (2 given)
```

**Примечание 4**. Таблица соответствия методов и операторов над множествами.

|A | B |Возвращает множество, являющееся объединением множеств |
|A.union(B) |A и B |
|---------------------------------|-----------------------------------------------------------------------|
|A |= B |Добавляет в множество A все элементы из множества B |
|A.update(B) | |
|---------------------------------|-----------------------------------------------------------------------|
|A & B |Возвращает множество, являющееся пересечением множеств A и B |
|A.intersection(B) | |
|---------------------------------|-----------------------------------------------------------------------|
|A &= B |Оставляет в множестве A только те элементы, которые есть в множестве B |
|A.intersection_update(B) | |
|---------------------------------|-----------------------------------------------------------------------|
|A - B |Возвращает разность множеств A и B |
|A.difference(B) | |
|---------------------------------|-----------------------------------------------------------------------|
|A -= B |Удаляет из множества A все элементы, входящие в B |
|A.difference_update(B) | |
|---------------------------------|-----------------------------------------------------------------------|
|A ^ B |Возвращает симметрическую разность множеств A и B |
|A.symmetric_difference(B) | |
|---------------------------------|-----------------------------------------------------------------------|
|A ^= B |Записывает в A симметрическую разность множеств A и B |
|A.symmetric_difference_update(B) | |
|---------------------------------|-----------------------------------------------------------------------|

**Примечание 5**. Приоритет операторов в порядке убывания (верхние операторы имеют более высокий приоритет, чем нижние) имеет вид:

| Оператор | Описание                |
| -------- | ----------------------- |
| -        | разность                |
| &        | пересечение             |
| ^        | симметрическая разность |
| \*       | \* объединение          |

[Тут](https://docs.python.org/3/reference/expressions.html#operator-precedence) можно посмотреть про операторы и их приоритеты в Python.
